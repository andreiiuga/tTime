<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>React JS</title>
</head>
<body>
    <div id="app"></div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/0.14.7/react-dom.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/5.8.23/browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.16.1/axios.min.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="index.css">
  	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.0/jquery.min.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/babel">

    	class HelloComponent extends React.Component {

    		constructor(props) {
				super(props);
				this.state = {city: 'Bucharest'};
			};

    		getWeatherInfo(city) {
    			var xhr = new XMLHttpRequest();
				xhr.open("GET", `http://api.openweathermap.org/data/2.5/weather?units=metric&q=${city}&APPID=30719c8a2baaffbfaaef83f39373f66d`, false);
				xhr.send();

				const weather_data = JSON.parse(xhr.response);
				console.log(weather_data);
				return weather_data;
    		};

    		changeLocation(e) {
    			console.log('ajunge');
    			var city_ref = this.refs.city;
    			var city_name = city_ref.value;
    			this.state = {city: city_name};

    			const weather = this.getWeatherInfo(this.state.city);

		        document.getElementById("weather").innerHTML = "tTime autside in " + weather.name + " is " + weather.weather[0].description;

		        document.getElementById("temp").innerHTML = "Temperature is arround " + weather.main.temp_max +"°C";

		        document.getElementById("wind").innerHTML = "Wind is going " + weather.wind.speed + "miles/hour";

		         e.preventDefault();
    		};

		    render() {

		        const weather = this.getWeatherInfo(this.state.city);
		        return (
		        	<span className="app">
			        	<h1 className="title">
			        		<span className="title-text">tTime</span>
			        	</h1>
			        	<div className="search-bar-wraper">
				            <form onSubmit={this.changeLocation.bind(this)}>
						    	<div className="input-group">
						      		<input type="text"
						      		ref="city"
						      		id="input_city"
						      		className="form-control"
						      		placeholder="Your City Here"
						      		/>
						      		<div className="input-group-btn">
						        		<div
						        		id="buton"
						        		onClick={this.changeLocation.bind(this)}
						        		className="btn btn-default">
						        			<i className="glyphicon glyphicon-search"></i>
						        		</div>
						      		</div>
						    	</div>
						  	</form>
						</div>
			        	<div id="weather" className="info-wraper">Currently in {weather.name} is {weather.weather[0].description}</div>
			        	<div id="temp" className="info-wraper">Temperature is arround {weather.main.temp_max}°C</div>
			        	<div id="wind" className="info-wraper">Wind is going {weather.wind.speed} miles/hour</div>
				  	</span>
		        )
		    }
		}
		ReactDOM.render(<HelloComponent />, document.querySelector('#app'))
    </script>
</body>
</html>